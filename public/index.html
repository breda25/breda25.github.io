<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Visitor Intelligence Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="color-scheme" content="dark light" />
  <style>
    :root {
      color-scheme: dark light;
      --bg: #0d1117;
      --bg-alt: #161b22;
      --border: #30363d;
      --fg: #c9d1d9;
      --fg-strong: #f0f6fc;
      --muted: #8b949e;
      --accent: #58a6ff;
      --danger: #f85149;
      --ok: #3fb950;
      --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      --mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
      --shadow: 0 18px 28px rgba(1,4,9,0.35);
      --blur-strength: 10px;
    }
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: var(--font);
      min-height: 100vh;
    }
    header {
      background: var(--bg-alt);
      border-bottom: 1px solid var(--border);
      padding: 20px clamp(16px, 5vw, 48px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }
    header h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
      color: var(--fg-strong);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    header svg {
      width: 28px;
      height: 28px;
      fill: currentColor;
    }
    header .status-pill {
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 13px;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(32,35,39,0.65);
    }
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: clamp(16px, 5vw, 48px);
      display: grid;
      gap: 24px;
    }
    form#authForm {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
      background: var(--bg-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      box-shadow: var(--shadow);
    }
    form#authForm label {
      display: flex;
      flex-direction: column;
      gap: 6px;
      color: var(--muted);
      font-size: 13px;
    }
    input[type="password"], input[type="search"], select {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--bg);
      color: var(--fg);
      font-family: var(--font);
      font-size: 14px;
    }
    input[type="password"]:focus, input[type="search"]:focus, select:focus {
      border-color: var(--accent);
      outline: none;
      box-shadow: 0 0 0 3px rgba(88,166,255,0.25);
    }
    button {
      padding: 11px 16px;
      border-radius: 8px;
      border: 1px solid transparent;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      background: var(--accent);
      color: #041422;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 20px rgba(35,134,255,0.25);
    }
    button.secondary {
      background: transparent;
      color: var(--muted);
      border-color: var(--border);
      box-shadow: none;
    }
    button.secondary:hover {
      border-color: var(--accent);
      color: var(--accent);
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
    }
    .controls > div {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    .hint {
      color: var(--muted);
      font-size: 13px;
    }
    .table-shell {
      position: relative;
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      background: var(--bg-alt);
      box-shadow: var(--shadow);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    thead {
      background: rgba(22,27,34,0.9);
    }
    th, td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--border);
      vertical-align: top;
    }
    th {
      font-weight: 600;
      color: var(--muted);
      white-space: nowrap;
    }
    td .pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 2px 8px;
      margin-right: 6px;
      background: rgba(56,139,253,0.12);
      color: var(--accent);
      font-size: 12px;
      font-family: var(--mono);
    }
    td .meta {
      display: grid;
      gap: 2px;
    }
    .ip {
      font-family: var(--mono);
      color: var(--fg-strong);
      font-size: 13px;
    }
    .ua, .small {
      font-size: 12px;
      color: var(--muted);
      word-break: break-all;
    }
    .locked tbody td {
      filter: blur(var(--blur-strength));
    }
    .locked tbody td::selection {
      background: transparent;
    }
    .table-shell.locked::after {
      content: "Protected — authenticate to reveal telemetry";
      position: absolute;
      inset: 0;
      display: grid;
      place-content: center;
      background: rgba(13,17,23,0.92);
      color: var(--muted);
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .status-line {
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--muted);
      font-size: 13px;
    }
    .status-line strong {
      color: var(--fg-strong);
      font-weight: 600;
    }
    .flash {
      color: var(--danger);
      font-weight: 600;
    }
    @media (max-width: 720px) {
      th, td { padding: 10px 12px; }
      header h1 { font-size: 18px; }
      button { width: 100%; }
      .controls { gap: 16px; }
      .controls > div { width: 100%; justify-content: flex-start; }
    }
  </style>
</head>
<body>
  <header>
    <h1>
      <svg viewBox="0 0 16 16" aria-hidden="true">
        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.94-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8Z"></path>
      </svg>
      Visitor Intelligence Console
    </h1>
    <span class="status-pill" id="badgeStatus">Lock engaged</span>
  </header>

  <main>
    <form id="authForm" autocomplete="off">
      <label>
        Operator passphrase
        <input id="password" type="password" inputmode="text" autocomplete="current-password" placeholder="Enter secure passphrase" required />
      </label>
      <div class="controls">
        <div>
          <button type="submit">Unlock feed</button>
          <button type="button" class="secondary" id="lockBtn">Re-lock</button>
        </div>
        <span class="hint" id="authHint">Telemetry is redacted until authentication succeeds.</span>
      </div>
    </form>

    <section>
      <div class="controls">
        <div>
          <input id="search" type="search" placeholder="Filter by IP, geo, UA, referrer, tz, lang…" />
          <select id="limit">
            <option value="50">Last 50</option>
            <option value="100" selected>Last 100</option>
            <option value="200">Last 200</option>
            <option value="500">Last 500</option>
          </select>
          <button type="button" class="secondary" id="refresh">Refresh</button>
        </div>
        <div class="status-line">
          <span id="status">Locked</span>
        </div>
      </div>
    </section>

    <div class="table-shell locked" id="tableShell">
      <table id="tbl" aria-describedby="status">
        <thead>
          <tr>
            <th scope="col">Time (UTC)</th>
            <th scope="col">IP &amp; Geo</th>
            <th scope="col">Device profile</th>
            <th scope="col">Page &amp; Referrer</th>
            <th scope="col">Client Context</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <p class="hint">
      This operational dashboard captures visitor telemetry with explicit consent and stores it securely inside a single-file encrypted datastore. Align retention and disclosure policies with your jurisdiction.
    </p>
  </main>

  <script type="module" src="/app.js"></script>
</body>
</html>
